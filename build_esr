#!/bin/bash
# Сборка проекта esr10/12V

# $1 - в качестве параметра необходимо передать config-esr10 config-esr12V

cd ~/esr-ldk-4-1-x
make clean
make $1
if [[ $? != 0 ]] ; then
	echo "ERROR config-esr10"
	exit 1
fi
make uboot
if [[ $? != 0 ]] ; then
	echo "ERROR uboot"
	exit 1
fi
make linux-userspace
if [[ $? != 0 ]] ; then
	echo "ERROR linux-userspace"
	exit 1
fi
make apps-all
if [[ $? -eq 0 ]] ; then 
	make firmware-initramfs
else
	make apps-all
	if [[ $? -eq 0 ]] ; then 
		make firmware-initramfs
	else
		make apps-all
		if [[ $? -eq 0 ]] ; then 
			make firmware-initramfs
		fi
	fi
fi

echo "BUILD ESR-10 DONE\n"
exit 0
